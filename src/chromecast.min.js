window.console||(window.console={log:function(){}}),console.log||(console.log=Function.prototype.bind.call(console.log,console)),!function(e,t){var n=function(){var e={};this.on=function(t,n){return e[t]=e[t]||[],e[t].push(n),this},this.off=function(t,n){return t in e==!1?this:(e[t].splice(e[t].indexOf(n),1),this)},this.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}this.on(e,n)},this.trigger=function(t){var n=this,i=arguments;return t in e==!1?this:void e[t].forEach(function(e){e.apply(n,[].slice.call(i,1))})}},i=function(e,t,n){var i=new Error(e);return i.arguments=t,i.permanent=!!n,i};i.type={mediaError:"mediaError",sessionError:"sessionError",extensionError:"extensionError"};var o={};o.events=new n;var s=function(){var e=this;this.session=t,this.appID=t,this.media=t;var n=!1;this.isReady=function(){return n},o.setReady=function(t){n=!!t,o.events.trigger(e.Events.ready)};var i=!1;this.isAvailable=function(){return i},o.setAvailable=function(t){i=!!t,o.events.trigger(e.Events.available)};var s=!1;this.isInitialized=function(){return s},o.setInitialized=function(t){s=!!t,o.events.trigger(e.Events.initialized)},this.getMedia=function(){return this.media},o.setMedia=function(t){e.media=t,this.media=e.media,t.addUpdateListener(function(t){t||(o.events.trigger(e.Events.mediaEnd),console.log("media update",": ended"))})}};s.prototype.setAppId=function(e){return this.appID||(this.appID=e||chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID),this.isInitialized()&&this.initCast(),this},s.prototype.MediaTypes={video:"video/mp4",audio:"audio/mp3",image:"image/jpg"},s.prototype.Events={error:"error",ready:"ready",available:"available",initialized:"initialized",session:"session",mediaDiscovered:"mediaDiscovered",mediaControl:"mediaControl",mediaEnd:"mediaEnd",extensionLoaded:"extensionLoaded"},s.prototype.startCast=function(e,t){function n(e){console.log("onmediadiscovered",arguments),o.setMedia(e),o.events.trigger(a.Events.mediaDiscovered)}function s(){console.log("onmediaerror",arguments);var e=i(i.type.mediaError,arguments);o.events.trigger(a.Events.error,e)}function r(){var i=a.getMediaRequest(e,t);a.session.loadMedia(i,n,s)}var a=this;a.session?r():a.getNewSession(r,function(e){console.log("error with playing video",e);var t=i(i.type.sessionError,arguments);o.events.trigger(a.Events.error,t)})},s.prototype.getNewSession=function(e,t){var n=this,i=function(t){console.log("onrequestsuccess",arguments),n.session=t,t.media&&t.media.length&&o.setMedia(t.media[0]),o.events.trigger(n.Events.session,t),e&&e(t)},s=function(e){console.log("onlauncherror",arguments),"receiver_unavailable"===e.code&&o.setAvailable(!1),t&&t(e)};chrome.cast.requestSession(i,s)},s.prototype.getMediaRequest=function(e,t){var n=new chrome.cast.media.MediaInfo(e);t=t||{},t.title=t.title||e,t.subtitle=t.subtitle||"Using FriendlyCast",n.contentType=t.contentType||this.MediaTypes.video,n.metadata=t;var i=new chrome.cast.media.LoadRequest(n);return i},s.prototype.initCast=function(){var e=this,t=function(t){e.session=t,t.media&&t.media.length&&o.setMedia(t.media[0]),o.setAvailable(!0),console.log("session listener",arguments)},n=function(e){o.setReady(!0),"available"===e&&o.setAvailable(!0),console.log("receiver listener",arguments)},i=function(){console.log("on init success",arguments),o.setReady(!0)},s=function(){console.log("cast on error",arguments)},r=new chrome.cast.SessionRequest(e.appID),a=new chrome.cast.ApiConfig(r,t,n);return chrome.cast.initialize(a,i,s),e},s.prototype.init=function(e){var t=this;return t.appID=e||t.appID,t.appID?(console.log("casting available",arguments),t.initCast()):t},s.prototype.disconnect=function(){this.session&&this.session.stop()};var r=function(e,t){return function(n){console.log("mediacontrol",t?"success":"error",e,arguments),n=n||{},n.command=e,n.success=!!t,o.events.trigger(s.prototype.Events.mediaControl,n)}},a=function(){};a.prototype.play=function(){o.media&&o.media.play(null,r("play",!0),r("play",!1))},a.prototype.pause=function(){o.media&&o.media.pause(null,r("pause",!0),r("pause",!1))},a.prototype.stop=function(){o.media&&o.media.stop(null,r("stop",!0),r("stop",!1))},a.prototype.seek=function(e){if(o.media){var t=new chrome.cast.media.SeekRequest;t.currentTime=e,o.media.seek(t,r("seek",!0),r("seek",!1))}},a.prototype.volume=function(e){return o.media&&o.session?("mute"===e?o.session.setReceiverVolumeLevel(e,r("mute",!0),r("mute",!1)):"unmute"===e?o.session.setReceiverVolumeLevel(e,r("unmute",!0),r("unmute",!1)):"number"==typeof e&&o.session.setReceiverVolumeLevel(e,r("volume",!0),r("volume",!1)),o.media.volume):void 0},a.prototype.status=function(){return o.media?o.media.playerState.toLowerCase():null},a.prototype.time=function(e){return o.media&&e===t?o.media.getEstimatedTime():void this.seek(e)},a.prototype.duration=function(){return o.media?o.media.media.duration:null},s.prototype.control=new a,s.prototype.on=function(e,t){return e===s.prototype.Events.ready&&this.isReady()?t():e===s.prototype.Events.available&&this.isAvailable()?t():e===s.prototype.Events.initialized&&this.isInitialized()&&t(),o.events.on(e,t),this},s.prototype.off=function(e,t){return o.events.off(e,t),this},s.prototype.once=function(e,t){return o.events.once(e,t),this},e.chromecast=new s,chromecast.on(chromecast.Events.session,function(e){o.session=e,e.media&&e.media.length&&o.setMedia(e.media[0])}),window.__onGCastApiAvailable=function(e,t){if(e)chromecast.init(),o.events.trigger(chromecast.Events.extensionLoaded);else{console.log("cast err",t);var n=i(i.type.extensionError,null,!0);o.events.trigger(chromecast.Events.error,n)}}}(this);